<div><a href="javascript:void(0)" class="inline-link f-instruction"><b>Показать инструкцию</b></a></div>
<div id="flexdiscount-instruction" class="hidden block">
    <h3>Инструкция к плагину "Гибкие скидки"</h3>
    <p>Общая информация о плагине представлена на странице его описания <a href="http://www.webasyst.ru/store/plugin/shop/flexdiscount/">Гибкие скидки</a></p>
    <p>Настоятельно советую прочитать шаг за шагом инструкцию, чтобы понимать, как работает плагин.</p>
    <div class="flexdiscount-question"><a href="javascript:void(0)">1) Что означают маски? <i class="icon16 rarr"></i></a></div>
    <div class='flexdiscount-answer'>
        <p>Маска - это краткое (символьное) обозначение той или иной скидки, которое поможет Вам идентифицировать скидки между собой. <br> Для того чтобы узнать, что означает 
            каждая маска, Вам необходимо после ее выбора в выпадающем списке навести курсор на голубой значок, расположенный слева. Появится всплывающее окно, кратко описывающее тип скидки.<br>
            Маски имеют в своих названиях "num" и "sum". Первое означает, что используется одна из скидок по количеству товаров, вторая - по сумме. Вместо этих сокращений в поле "Значение маски"
            необходимо поставить цифру, которая и будет условием скидки (подробнее в следующем вопросе).
        </p>
        <p>Если хотите ознакомиться с полным описанием каждой маски, <a href="javascript:void(0)" onclick="$('.f-mask-desc').toggle()" class="inline-link"><b>нажмите сюда</b></a></p>
        <div class="hidden f-mask-desc">
            <ol>
                <li>
                    <b><i>&gt;num</i></b> - 
                    При покупке более X любых единиц товара устанавливается скидка на все товары в заказе<em>,
                    </em> удовлетворяющие выставленным условиям, таким как "Категория товара" и "Тип товара".    <br>
                    <em>Пример, (>2): при покупке более 2-х единиц товара устанавливается скидка 10% на все товары, удовлетворяющие выставленным условиям.</em>
                </li>
                <li>
                    <b><i>&gt;num%sumZ</i></b> - 
                    При покупке больше X любых единиц товара устанавливается скидка на все товары при условии, что сумма покупки не менее Z.    <br>
                    <em>Пример, (>2%1500): при покупке более 2-х единиц товара устанавливается скидка 10% на все товары, если их стоимость не менее 1500 руб.</em>
                </li>
                <li>
                    <b><i>%num</i></b> - 
                    Скидка на каждый i-й одинаковый товар.  <em>Пример, (%3): пусть заказали 3 одинаковых яблока. Скидка на третье яблоко будет 10%.
                        <br>- пусть заказали 5 одинаковых яблока. Скидка на третье яблоко будет 10%. 
                        <br>- пусть заказали 6 одинаковых яблока. Скидка на третье и шестое яблоко будет 10%.</em>
                </li>
                <li>
                    <b><i>numX%numY</i></b> - 
                    При покупке X одинаковых товаров устанавливается скидка на Y товаров из этого числа.<br>
                    <em>Пример, (3%2): пусть заказали 3 одинаковых яблока. Скидка на два из них будет 10%.<br>
                        - (3%3): пусть заказали 3 одинаковых яблока. Скидка на все три яблока будет 10%.</em>
                </li>
                <li>
                    <b><i>&gt;%num</i></b> - 
                    При покупке больше X одинаковых товаров устанавливается скидка на все товары из этого списка<em>.
                        <br>Пример, (&gt;%2): при покупке более 2-х одинаковых яблок устанавливается скидка 10% на эти яблоки.</em>
                </li>
                <li>
                    <b><i>&gt;%num#</i></b> - 
                    При покупке больше Х одинаковых товаров устанавливается скидка на последующие вещи из списка.<em>
                        <br>Пример,(&gt;%2#): пусть заказали 2 одинаковых яблока. Скидка на третье, четвертое и последующие будет 10%.</em>
                </li>
                <li>
                    <b><i>=num</i></b> - 
                    При покупке только определенного числа любых товаров устанавливается общая скидка.<em>
                        <br>Пример, (=2): при заказе 2-х любых яблок устанавливается скидка 10%.
                        <br>- при заказе 3-х любых яблок скидка не подействует.</em>
                </li>
                <li>
                    <b><i>=%num</i></b> - 
                    При покупке только определенного числа одинаковых товаров устанавливается скидка.<em>
                        <br>Пример, (=%2): при заказе 2-х одинаковых яблок устанавливается скидка 10%.
                        <br>- при заказе 3-х любых яблок и 2-х одинаковых скидка будет 10% на 2 одинаковых яблока.</em>
                </li>
                <li>
                    <b><i>numX#numY</i></b> -
                    При покупке X любых товаров устанавливается скидка на 1шт Y единиц товаров самой низкой цены из этого списка<br>
                    <em>Пример, (3#2): 
                        <br>У нас имеется категория Яблоки и скидка 10%. Товар первый: яблоко1 - 1000р, товар второй: яблоко2: 1500р, товар третий: яблоко3 - 500р.<br>
                        Мы купили яблоко1, яблоко2 и 3 яблока3. Скидка будет распространяться на 1шт яблоко1 и 1шт яблоко3 и будет равна 150р.
                    </em>
                </li>
                <li>
                    <b><i>numX#numY#</i></b> -
                    При покупке X любых товаров устанавливается скидка на Y товаров самой низкой цены из этого списка<br>
                    <em>Пример, (3#2): 
                        <br>У нас имеется категория Яблоки и скидка 10%. Товар первый: яблоко1 - 1000р, товар второй: яблоко2: 1500р, товар третий: яблоко3 - 500р.<br>
                        Мы купили яблоко1, яблоко2 и 3 яблока3. Скидка будет распространяться на 2шт яблока3 и будет равна 100р.
                    </em>
                </li>
                <li>
                    <b><i>numX#numY#sumZ</i></b> -
                    При покупке X любых товаров устанавливается скидка на 1шт Y единиц товаров самой низкой цены из этого списка. 
                    Скидка начинает работать при цене одного из товаров не ниже Z<br>
                    <em>Пример, (3#2#1200): 
                        <br>У нас имеется категория Яблоки, скидка 10% и минимальный порог 1200р. Товар первый: яблоко1 - 1000р, товар второй: яблоко2: 1500р, товар третий: яблоко3 - 500р.<br>
                        Мы купили яблоко1, яблоко2 и 3 яблока3. Скидка будет распространяться на 1шт яблоко1 и 1шт яблоко3 и будет равна 150р.<br>
                        Если бы мы поставили минимальный порог 1501р, то скидка бы не сработала.
                    </em>
                </li>
                <li>
                    <b><i>numX#numY#sumZ#</i></b> -
                    При покупке X любых товаров устанавливается скидка на Y товаров самой низкой цены из этого списка. 
                    Скидка начинает работать при цене одного из товаров не ниже Z<br>
                    <em>Пример, (3#2#1200): 
                        <br>У нас имеется категория Яблоки, скидка 10% и минимальный порог 1200р. Товар первый: яблоко1 - 1000р, товар второй: яблоко2: 1500р, товар третий: яблоко3 - 500р.<br>
                        Мы купили яблоко1, яблоко2 и 3 яблока3. Скидка будет распространяться на 2шт яблока3 и будет равна 100р.<br>
                        Если бы мы поставили минимальный порог 1501р, то скидка бы не сработала.
                    </em>
                </li>
                <li>
                    <b><i>=</i></b> - 
                    Скидка на всю Категорию товара, либо Тип товара не зависимо от количества заказанных товаров.
                </li>
                <li>
                    <b><i>-</i></b> - 
                    Запрет на применение скидок для конкретной категории или типа товаров.<br>
                    <em>Пример, у Вас имеются товары, на которые скидка не должна распространяться.</em>
                </li>
                <li>
                    <b><i>&gt;sum</i></b> - 
                    При покупке товаров на сумму, большую чем X, устанавливается скидка на определенную категорию, определенный тип товаров.  <br>
                    <em>Пример, (&gt;1000): пусть у нас имеются две категории: яблоки и апельсины .
                        <br>Значение скидки &gt;1000 для категории Яблоки. Если мы купили яблок и апельсинов на сумму 1500, то нам полагается скидка 10% только на Яблоки.</em>
                </li>
                <li>
                    <b><i>&gt;%sum</i></b> - 
                    При покупке в определенной категории определенный тип товаров на сумму, большую чем X, устанавливается общая скидка на весь заказ.<br>
                    <em>Пример, (&gt;%1000): у нас имеются две категории: яблоки и апельсины .
                        <br>Значение скидки &gt;1000 для категории Яблоки. Если мы купили яблок на сумму 1200 и апельсинов на сумму 300, то нам полагается скидка 10% на 
                        весь заказ. Если же наоборот, яблок на сумму 300, а апельсинов - 1200, то скидки не будет.</em>
                </li>
                <li>
                    <b><i>&gt;%sum#</i></b>
                    При покупке в определенной категории определенный тип товаров на сумму, большую чем X, устанавливается скидка только на эту же категорию, 
                    этот же тип товара.<br>
                    <em>Пример, (&gt;%1000#): у нас имеются две категории: яблоки и апельсины .
                        <br>Значение скидки &gt;1000 для категории Яблоки. Если мы купили яблок на сумму 1200 и апельсинов на сумму 1300, то нам полагается скидка 
                        10% только на Яблоки.</em>
                </li>
                <li>
                    <b><i>&gt;=set#</i></b> - 
                    При покупке более(или равно) X наборов (по одной уникальной единице) товаров из указанной категории начисляется скидка на все <i>товары</i> указанной категории<br>
                    <em>Пример, (&gt;=1#): пусть у нас имеется скидка 10% и категория Красные яблоки, в которой находится 3 разных товара (яблоко1 - 500р, яблоко2 - 700р, яблоко3 - 300р).
                        Установлено правило скидок именно на эту категорию.
                        <br>Если мы купили 3шт яблоко1, 1шт яблоко2, 2шт яблоко3. В итоге имеем 1 набор (по одной уникальной единице каждого товара из категории).
                        Это значит, что скидка должна сработать и распространиться на все товары (яблоко1 - 150р, яблоко2 - 70р, яблоко3 - 60р). Скидка равна 280р<br>
                        Если бы мы указали значение скидки (&gt;=2#), то при данном количестве товаров у нас бы не набралось 2 набора и соответственно скидка бы не сработала.
                    </em>
                </li>
                <li>
                    <b><i>&gt;=%set</i></b> - 
                    При покупке более(или равно) X наборов (по одной уникальной единице) товаров из указанной категории начисляется скидка на все <i>наборы</i> указанной категории.
                    Используйте товары с одинаковой ценой артикулов<br>
                    <em>Пример, (&gt;=1#): пусть у нас имеется скидка 10% и категория Красные яблоки, в которой находится 3 разных товара (яблоко1 - 500р, яблоко2 - 700р, яблоко3 - 300р).
                        Установлено правило скидок именно на эту категорию.
                        <br>Если мы купили 3шт яблоко1, 1шт яблоко2, 2шт яблоко3. В итоге имеем 1 набор (по одной уникальной единице каждого товара из категории).
                        Это значит, что скидка должна сработать и распространиться только на набор (яблоко1 - 50р, яблоко2 - 70р, яблоко3 - 30р). Скидка равна 150р<br>
                        Если бы мы указали значение скидки (&gt;=2#), то при данном количестве товаров у нас бы не набралось 2 набора и соответственно скидка бы не сработала.
                    </em>
                </li>
                <li>
                    <b><i>&gt;=set</i></b> - 
                    При покупке более(или равно) X наборов (по одной уникальной единице) товаров из указанной категории начисляется скидка на весь заказ<br>
                    <em>Пример, (&gt;=1#): пусть у нас имеется скидка 10% и категория Красные яблоки, в которой находится 3 разных товара (яблоко1 - 500р, яблоко2 - 700р, яблоко3 - 300р).
                        Также мы имеем категорию Апельсины (каждый стоит 30р за шт), которая не попадает под влияние данной скидки. Установлено правило скидок именно на категорию Красные яблоки.
                        <br>Если мы купили 3шт яблоко1, 1шт яблоко2, 2шт яблоко3, 5 апельсинов. В итоге имеем 1 набор (по одной уникальной единице каждого товара из категории Красные яблоки).
                        Это значит, что скидка должна сработать и распространиться на весь заказ (яблоко1 - 150р, яблоко2 - 70р, яблоко3 - 60р, апельсины - 15р). Скидка равна 295р<br>
                        Если бы мы указали значение скидки (&gt;=2#), то при данном количестве товаров у нас бы не набралось 2 набора и соответственно скидка бы не сработала.
                    </em>
                </li>
                <li>
                    <b><i>&gt;customerTotal</i></b> - 
                    Скидка для конкретной категории или типа товаров по общей сумме всех заказов покупателя.
                </li>
                <li>
                    Скидка по категории покупателя (постоянный покупатель, оптовый покупатель и тд.).
                </li>
            </ol>
        </div>
    </div>
    <div class="flexdiscount-question"><a href="javascript:void(0)">2) Что писать в поле "Значение маски"? <i class="icon16 rarr"></i></a></div>
    <div class='flexdiscount-answer'>
        <p>Данное поле означает условие вашего правила скидок. Вместо "num", "sum", "set" или "customerTotal" нужно написать число-условие. <br>
            <img src="{$plugin_url}img/example.jpg" class="adaptive-img" /><br>
            В первом случае мы имеем: При покупке товаров на сумму, большую чем 5000р, устанавливается скидка на любые товары.<br>
            Во втором: При покупке больше 3 одинаковых товаров устанавливается скидка на последующие вещи для любых категорий и типов товаров.
        </p>
    </div>
    <div class="flexdiscount-question"><a href="javascript:void(0)">3) Как использовать купоны? <i class="icon16 rarr"></i></a></div>
    <div class='flexdiscount-answer'>
        <p>
            <img src="{$plugin_url}img/example2.jpg" alt="" /><br>
            Во-первых, Вам необходимо создать купон. При создании можно указать максимальное количество его использований и дату истечения. В комментарии купона пишите любой 
            текст, который поможет Вам распознать его назначение. Этот текст видите только Вы. <br>
            Также Вы можете изменить цвет купона, кликнув по его иконке, расположенной слева от кода купона.<br>
            Нажмите Сохранить.<br><br>
            Во-вторых, после создания купона присвойте его любому правилу скидок. Рядом с каждым правилом есть серая иконка купона. Нажмите на нее и выберите нужный купон.
            Не забывайте сохранять изменения.<br>
            <img src="{$plugin_url}img/example3.jpg" alt="" /><br><br>
            В-третьих, для ввода купонов на витрине магазина Вы должны использовать специальную форму. В "Дополнительных настройках" ниже имеется опция "Вывести форму ввода купона".
            Нажмите Вкл. Форма появится в Корзине (шаблон cart.html) в том месте, где у Вас расположен код:<br>
        <div class="align-center">
            <div class="print-code">
                &lt;!-- plugin hook: 'frontend_cart' --&gt;<br>
                {ldelim}* @event frontend_cart.%plugin_id% *{rdelim}  <br>
                {ldelim}foreach $frontend_cart as $_{rdelim}{ldelim}$_{rdelim}{ldelim}/foreach{rdelim} <br>
            </div><br>
        </div>
        Для того чтобы вывести форму в любое удобное для Вас место, используйте код: <b>{ldelim}$wa-&gt;block("flexdiscount.form"){rdelim}</b> в любом <a href="{$wa_backend_url}shop/?action=storefronts" target="_blank">шаблоне <i class="icon16 new-window"></i></a>.
        </p>
        <p>Изменить текст ввода можно в разделе <a href="{$wa_backend_url}site/#/blocks/id=flexdiscount.form" target="_blank">Блоки <i class="icon16 new-window"></i></a><br>
            <b>ВНИМАНИЕ!</b> При изменении не удаляйте классы: <i>flexdiscount-coupon-code</i> и <i>flexdiscount-submit-button</i></p>
    </div>
    <div class="flexdiscount-question"><a href="javascript:void(0)">4) Почему не сохраняются скидки? <i class="icon16 rarr"></i></a></div>
    <div class='flexdiscount-answer'>
        <p>Это может быть, если Вы не заполните поля скидок, либо поля бонусов, а именно Скидку в процентах или Скидку в валюте, поля Бонуса. Также, если поле "Значение маски" будет пустым, то скидка не сохранится.<br>
            Исключением являются скидки для категорий контактов и маски ("-", "=").
        </p>
    </div>
    <div class="flexdiscount-question"><a href="javascript:void(0)">5) Начисление бонусов? <i class="icon16 rarr"></i></a></div>
    <div class='flexdiscount-answer'>
        <p>Помимо скидок в процентах и валюте плагин позволяет начислять еще и партнерские бонусы.</p>
        <p>Бонусы могут быть начислены в фиксированном размере, либо в процентах от стоимости товара.</p>
        <p>Если Вы хотите показать пользователю, сколько бонусов он получил, то используйте код:</p>
        <div class="align-center">
            <div class="print-code">
                &#123;shopFlexdiscountPluginHelper::getUserAffiliate()&#125;
            </div><br>
        </div>
        <img src="{$plugin_url}img/example11.jpg" alt="" /><br><br>
        <p>Изменить текст можно в <a href="{$wa_backend_url}site/#/blocks/id=flexdiscount.affiliate" target="_blank">Блоках <i class="icon16 new-window"></i></a></p>
    </div>
    <div class="flexdiscount-question"><a href="javascript:void(0)">6) Отличие "примененных", "действующих" и "доступных" скидок <i class="icon16 rarr"></i></a></div>
    <div class='flexdiscount-answer'>
        <p>С помощью плагина Вы можете сообщить пользователю о том, какие скидки ему доступны, или какие он использует в данных момент. Для этого можете 
            воспользоваться "Дополнительными настройками" или ручным выводом нужных блоков.</p>
        <p>Существует 3 конструкции и соответственно 3 понятия:</p>
        <ol>
            <li><u>Примененные скидки</u> - это скидки, которые уже действуют для покупателя.
            Он либо получил скидку изначально, либо уже выполнил какое-либо из условий для ее получения.</li>
            <li><u>Действующие скидки</u> - это скидки, которые будут у покупателя, если он совершит покупку того или иного товара. Данные скидки рассчитываются "на будущее".
            К примеру, покупатель находится на странице товара и выбирает какое количество ему купить и какой из артикулов выбрать. Он нажимает на певый артикул,
            выбирает количество, но не нажимает кнопку "В корзину". Плагин в это время предполагает, что покупатель отложит товар в корзину и рассчитывает значения скидок с 
            учетом этого товара, после чего выводит ему, какие скидки получит покупатель. <br>
            Данные значения динамически обновляются при выборе артикулов и изменении количества товаров. <br>
            <b>Рекомендуется</b> использовать действующие скидки для отображения актуальных скидок для товара, которые будут динамически изменяться.
            </li>
            <li><u>Доступные скидки</u> - это скидки, которые покупатель может получить впринципе. Алгоритм работы таков: перебираются все Ваши правила скидок, 
            проверяется, подходит ли товар под них, высчитывается скидка для товара. Можно также показывать доступные скидки не только для конкретного товара, но и для всех, демонстрируя перечень ваших скидок.</li>
        </ol>
        <p>Действующие и доступные скидки могут быть выведены несколько раз и по-разному.</p>
    </div>
    <div class="flexdiscount-question"><a href="javascript:void(0)">7) Вывод "примененных", "действующих" и "доступных" скидок <i class="icon16 rarr"></i></a></div>
    <div class='flexdiscount-answer'>
        <p>
            а) <u>Примененные скидки</u>: код для встраивания в шаблон <b><i>&#123;shopFlexdiscountPluginHelper::getUserDiscounts()&#125;</i></b>
        </p>
        <p>
            б) <u>Действующие скидки</u>: <br>
        Общая конструкция: <br><br>&#123;shopFlexdiscountPluginHelper::getProductDiscounts($product, $view_type, $sku_id)&#125; , где<br><br>
        $product - массив, содержащий данные о товаре, <br>
        $view_type - тип отображения (1, 2, 3, 4 или 5); Вы можете создать свой тип. Об этом подробнее в следующем вопросе.<br>
        $sku_id - ID артикула товара. Если Вы не знаете откуда его брать, то не используйте. Плагин подберет его сам.<br>
        <span class="indent25px">1. Вывод на странице товара <b><i>&#123;shopFlexdiscountPluginHelper::getProductDiscounts($product)&#125;</i></b></span><br>
        <span class="indent25px">2. Вывод на странице товара с указанием типа отображения <b><i>&#123;shopFlexdiscountPluginHelper::getProductDiscounts($product, 2)&#125;</i></b></span><br>
        <span class="indent25px">3. Вывод  в каталоге <b><i>&#123;shopFlexdiscountPluginHelper::getProductDiscounts($p)&#125;</i></b></span><br>
        <span class="indent25px">4. Вывод в каталоге с указанием типа отображения <b><i>&#123;shopFlexdiscountPluginHelper::getProductDiscounts($p, 3)&#125;</i></b></span><br>
        </p>
        <p>
            б) <u>Доступные скидки</u>: <br>
        Общая конструкция: <br><br>&#123;shopFlexdiscountPluginHelper::getAvailibleDiscounts($product, $view_type)&#125; , где<br><br>
        $product - массив, содержащий данные о товаре, <br>
        $view_type - тип отображения (1, 2, 3 или 4); Вы можете создать свой тип. Об этом подробнее в следующем вопросе.<br>
        <span class="indent25px">1. Вывод на странице товара <b><i>&#123;shopFlexdiscountPluginHelper::getAvailibleDiscounts($product)&#125;</i></b></span><br>
        <span class="indent25px">2. Вывод на странице товара с указанием типа отображения <b><i>&#123;shopFlexdiscountPluginHelper::getAvailibleDiscounts($product, 2)&#125;</i></b></span><br>
        <span class="indent25px">3. Вывод  в каталоге <b><i>&#123;shopFlexdiscountPluginHelper::getAvailibleDiscounts($p)&#125;</i></b></span><br>
        <span class="indent25px">4. Вывод в каталоге с указанием типа отображения <b><i>&#123;shopFlexdiscountPluginHelper::getAvailibleDiscounts($p, 3)&#125;</i></b></span><br>
        <span class="indent25px">5. Вывод доступных скидок для всего магазина <b><i>&#123;shopFlexdiscountPluginHelper::getAvailibleDiscounts()&#125;</i></b></span><br>
        <span class="indent25px">6. Вывод доступных скидок для всего магазина с указанием типа отображения <b><i>&#123;shopFlexdiscountPluginHelper::getAvailibleDiscounts(null, 3)&#125;</i></b></span><br>
        </p>
    </div>
    <div class="flexdiscount-question"><a href="javascript:void(0)">8) Типы отображения скидок <i class="icon16 rarr"></i></a></div>
    <div class='flexdiscount-answer'>
        <p>Существут 4 типа отображения скидок на витрине:<br>
            Первый (цифра 1): подходит для страницы товара <br><img src="{$plugin_url}img/example7.jpg" alt="" /><br><br>
            Второй (цифра 2): подходит для страницы товара <br><img src="{$plugin_url}img/example6.jpg" alt="" /><br><br>
            Третий (цифра 3): подходит для страницы товара <br><img src="{$plugin_url}img/example5.jpg" alt="" /><br><br>
            Четвертый (цифра 4): подходит для каталога <br><img src="{$plugin_url}img/example4.jpg" alt="" /><br><br>
        </p>
        <p>В данных примерах использовались доступные скидки и конструкции кода соответственно:<br>
            <i>&#123;shopFlexdiscountPluginHelper::getAvailibleDiscounts($product, 1)&#125;</i><br>
            <i>&#123;shopFlexdiscountPluginHelper::getAvailibleDiscounts($product, 2)&#125;</i><br>
            <i>&#123;shopFlexdiscountPluginHelper::getAvailibleDiscounts($product, 3)&#125;</i><br>
            <i>&#123;shopFlexdiscountPluginHelper::getAvailibleDiscounts($p, 4)&#125;</i><br>
        </p>
        <p>Имеется также и пятый, но он доступен только в "действующих скидках" и сделан в качестве примера:</p>
        <img src="{$plugin_url}img/example10.jpg" alt="" /><br><br>
        <p>В последнем примере был сделал вывод в каталоге и использовался код: <i>&#123;shopFlexdiscountPluginHelper::getProductDiscounts($p, 5)&#125;</i></p>
        <p>Вы можете изменить текущие типы отображения и создать свои в разделе <a href="{$wa_backend_url}site/#/blocks/" target="_blank">Блоки <i class="icon16 new-window"></i></a></p>
        <p>Четвертый тип сделан в качестве примера по созданию своего собственного.</p>
        <p><b><i>Обязательные классы и атрибуты для типов отображения</i></b></p>
        <p>При создании типов отображения для <u>"доступных скидок"</u> используйте следующие классы и атрибуты:<br>
        для списков &lt;li data-sku-id='&#123;$sku_id&#125;' class='discount-skus'&gt;<br>
        для таблиц &lt;tr data-sku-id='&#123;$sku_id&#125;' class='discount-skus'&gt;
        </p>
        <p>Это необходимо для смены скидок при выборе артикула с другой ценой</p>
        <p>При создании типов отображения для <u>"действующих скидок"</u> используйте обязательные конструкции, которые уже созданы в <a href="{$wa_backend_url}site/#/blocks/id=flexdiscount.product.discounts" target="_blank">Блоках <i class="icon16 new-window"></i></a> действующих скидок</a><br>

        <p><b><i>Управление выводом скидок</i></b></p>
        <p>Вы можете выводить информацию не обо всех скидках на витрину, а только о тех, которые Вам необходимы. Для этого у каждого правила скидок имеется поле "Символьный код"<br>
            <img src="{$plugin_url}img/example8.jpg" alt="" /></p>
        <p>Используя символьный код Вы можете ограничивать вывод каких-либо скидок на Витрину, либо видоизменять их отображение.</p>
        <p>Вот пример управления выводом. Используем Блок <i>flexdiscount.available</i>, четвертый тип отображения:</p>
        {$nbsp = "&nbsp;&nbsp;&nbsp;&nbsp;"}
        <div class="align-center">
            <div class="print-code">
                &lt;table class="flexdiscount-table align-center"&gt;<br>
                {$nbsp}&#123;foreach $discounts as $sku_id =&gt; $discount&#125;<br>
                {$nbsp}{$nbsp}&#123;foreach $discount as $d&#125;<br>
                {$nbsp}{$nbsp}{$nbsp}&lt;tr data-sku-id='&#123;$sku_id&#125;' <b>&#123;if $d.params.code == 'mydiscount'&#125;style='background: #ff0000'&#123;/if&#125;</b> class='discount-skus'&gt;<br>
                {$nbsp}{$nbsp}{$nbsp}{$nbsp}&lt;td&gt;&#123;$d.name|escape&#125;&lt;/td&gt;<br>
                {$nbsp}{$nbsp}{$nbsp}{$nbsp}&lt;td&gt;&#123;$d.price&#125;&lt;/td&gt;<br>
                {$nbsp}{$nbsp}{$nbsp}&lt;/tr&gt;<br>
                {$nbsp}{$nbsp}&#123;/foreach&#125;<br>
                {$nbsp}&#123;/foreach&#125;<br>
                &lt;/table&gt;<br>
            </div><br>
        </div>
        <p>В результате получим:<br><img src="{$plugin_url}img/example9.jpg" alt="" /></p>
    </div>
    <div class="flexdiscount-question"><a href="javascript:void(0)">9) Доступные переменные при выводе скидок <i class="icon16 rarr"></i></a></div>
    <div class='flexdiscount-answer'>
        <p>В  блоки "доступных", "действующих", "примененных" скидок передаются переменные, содержащие информацию о текущих скидках. Вы можете выбирать, какую информацию вывести, 
            а какую скрыть.</p>
        <p>Массив переменных блока "Действующих скидок" (flexdiscount.product.discounts)</p>
        <div class="align-center">
            <div class="print-code">
                $workflow = array(полная информация о скидках<br>
                {$nbsp}'discount' =&gt; общая скидка для товара,<br>
                {$nbsp}'discount_html' =&gt; общая скидка для товара с символом рубля,<br>
                {$nbsp}'clear_discount' =&gt; чистая скидка без валют,<br>
                {$nbsp}'affiliate' =&gt; количество бонусов,<br>
                {$nbsp}'currency' =&gt; валюта товара,<br>
                {$nbsp}'quantity' =&gt; количество товара,<br>
                {$nbsp}'price' =&gt; цена товара со скидкой,<br>
                {$nbsp}'price_html' =&gt; цена товара со скидкой с символом рубля,<br>
                {$nbsp}'clear_price' =&gt; чистая цена без валют,<br>
                {$nbsp}'real_price' =&gt; цена товара без скидок,<br>
                {$nbsp}'product' =&gt; array() данные о товаре,<br>
                {$nbsp}'items' =&gt; array(значения примененных скидок<br>
                {$nbsp}{$nbsp}'discount' =&gt; скидка,<br>
                {$nbsp}{$nbsp}'discount_html' =&gt; скидка с символом рубля,<br>
                {$nbsp}{$nbsp}'clear_discount' =&gt; чистая скидка без валют,<br>
                {$nbsp}{$nbsp}'affiliate' =&gt; бонус,<br>
                {$nbsp}{$nbsp}'name' =&gt; название скидки,<br>
                {$nbsp}{$nbsp}'params' =&gt; array( информация о правиле скидок<br>
                {$nbsp}{$nbsp}{$nbsp}'discount' =&gt; абсолютное значение скидки в валюте,<br>
                {$nbsp}{$nbsp}{$nbsp}'discount_percentage' =&gt; процентное значение скидки,<br>
                {$nbsp}{$nbsp}{$nbsp}'affiliate' =&gt; бонусы,<br>
                {$nbsp}{$nbsp}{$nbsp}'mask' =&gt; маска правила скидок, <br>
                {$nbsp}{$nbsp}{$nbsp}'code' =&gt; символьный код скидки,<br>
                {$nbsp}{$nbsp}{$nbsp}'discounteachitem' =&gt; использовалось ли условие начисления скидки на каждый товар,<br>
                {$nbsp}{$nbsp}),<br>
                {$nbsp}'deny' =&gt; (bool). Был ли хоть раз применен запрет скидки для товара<br>
                {$nbsp});<br>
                );<br><br>
                $discounts = array(значения примененных скидок<br>
                {$nbsp}ID артикула =&gt; array(<br>
                {$nbsp}{$nbsp}'discount' =&gt; скидка,<br>
                {$nbsp}{$nbsp}'discount_html' =&gt; скидка с символом рубля,<br>
                {$nbsp}{$nbsp}'clear_discount' =&gt; чистая скидка без валют,<br>
                {$nbsp}{$nbsp}'affiliate' =&gt; бонус,<br>
                {$nbsp}{$nbsp}'name' =&gt; название скидки,<br>
                {$nbsp}{$nbsp}'params' =&gt; array( информация о правиле скидок<br>
                {$nbsp}{$nbsp}{$nbsp}'discount' =&gt; абсолютное значение скидки в валюте,<br>
                {$nbsp}{$nbsp}{$nbsp}'discount_percentage' =&gt; процентное значение скидки,<br>
                {$nbsp}{$nbsp}{$nbsp}'affiliate' =&gt; бонусы,<br>
                {$nbsp}{$nbsp}{$nbsp}'mask' =&gt; маска правила скидок, <br>
                {$nbsp}{$nbsp}{$nbsp}'code' =&gt; символьный код скидки,<br>
                {$nbsp}{$nbsp}{$nbsp}'discounteachitem' =&gt; использовалось ли условие начисления скидки на каждый товар,<br>
                {$nbsp}{$nbsp})<br>
                {$nbsp})<br>
                );<br><br>
                $view_type = (int) Тип отображения скидок<br>
            </div><br><br>
        </div>
        <p>Массив переменных блока "Доступных скидок" (flexdiscount.available)</p>
        <div class="align-center">
            <div class="print-code">
                $discounts = array(значения примененных скидок<br>
                {$nbsp}ID артикула =&gt; array(<br>
                {$nbsp}{$nbsp}'discount' =&gt; скидка,<br>
                {$nbsp}{$nbsp}'discount_html' =&gt; скидка с символом рубля,<br>
                {$nbsp}{$nbsp}'price' =&gt; цена товара со скидкой,<br>
                {$nbsp}{$nbsp}'price_html' =&gt; цена товара со скидкой с символом рубля,<br>
                {$nbsp}{$nbsp}'clear_price' =&gt; чистая цена без валют,<br>
                {$nbsp}{$nbsp}'currency' =&gt; валюта товара,<br>
                {$nbsp}{$nbsp}'affiliate' =&gt; бонус,<br>
                {$nbsp}{$nbsp}'name' =&gt; название скидки,<br>
                {$nbsp}{$nbsp}'params' =&gt; array( информация о правиле скидок<br>
                {$nbsp}{$nbsp}{$nbsp}'discount' =&gt; абсолютное значение скидки в валюте,<br>
                {$nbsp}{$nbsp}{$nbsp}'discount_percentage' =&gt; процентное значение скидки,<br>
                {$nbsp}{$nbsp}{$nbsp}'affiliate' =&gt; бонусы,<br>
                {$nbsp}{$nbsp}{$nbsp}'mask' =&gt; маска правила скидок, <br>
                {$nbsp}{$nbsp}{$nbsp}'code' =&gt; символьный код скидки,<br>
                {$nbsp}{$nbsp}{$nbsp}'discounteachitem' =&gt; использовалось ли условие начисления скидки на каждый товар,<br>
                {$nbsp}{$nbsp})<br>
                {$nbsp})<br>
                );<br><br>
                $view_type = (int) Тип отображения скидок<br><br>
                $deny = (bool). Был ли хоть раз применен запрет скидки для товара<br>
            </div><br><br>
        </div>
        <p>Массив переменных блока "Примененных скидок" (flexdiscount.discounts)</p>
        <div class="align-center">
            <div class="print-code">
                $discounts = array(примененные скидки<br>
                {$nbsp}'name' =&gt; название скидки,<br>
                {$nbsp}'discount' =&gt; общая скидка для товара,<br>
                {$nbsp}'discount_html' =&gt; общая скидка для товара с символом рубля,<br>
                {$nbsp}'affiliate' =&gt; количество бонусов,<br>
                );
            </div><br><br>
        </div>
    </div>
    <div class="flexdiscount-question"><a href="javascript:void(0)">10) Вывод цены со скидкой на витрину <i class="icon16 rarr"></i></a></div>
    <div class='flexdiscount-answer'>
        <p>Плагин позволяет Вам выводить в каталоге или на странице товара цену со скидкой. Вы можете заменить ею стандартный вывод цены, если захотите.</p>
        <p>Общая конструкция: &#123;shopFlexdiscountPluginHelper::price($product, $sku_id, $html)&#125; , где<br>
            $product - массив с данными о товаре, <br>
            $sku_id - ID артикула товара (необязательный параметр). Используется при выводе цены для артикулов.<br>
            $html - использовать символ рубля или нет (1 или 0)
        </p>
        <p>Код для каталога (шаблон list-thumbs.html или list-table.html):</p>
        <div class="align-center">
            <div class="print-code">
                &#123;shopFlexdiscountPluginHelper::price($p)&#125;
            </div><br><br>
        </div>
        <p>Код для каталога с символом рубля (шаблон list-thumbs.html или list-table.html):</p>
        <div class="align-center">
            <div class="print-code">
                &#123;shopFlexdiscountPluginHelper::price($p, '', 1)&#125;
            </div><br><br>
        </div>
        <p>Код для страницы товара (шаблон product.html):</p>
        <div class="align-center">
            <div class="print-code">
                &#123;shopFlexdiscountPluginHelper::price($product)&#125;
            </div><br><br>
        </div>
        <p>Код для страницы товара с символом рубля (шаблон product.html):</p>
        <div class="align-center">
            <div class="print-code">
                &#123;shopFlexdiscountPluginHelper::price($product, '', 1)&#125;
            </div><br><br>
        </div>
        <p>Код для страницы товара , вывод цены для артикула (шаблон product.cart.html):
            <br> найдите у себя в шаблоне примерно следующий код, либо попросите разработчика
        </p>
        <div class="align-center">
            <div class="print-code">
                &lt;!-- SKU selector --&gt;<br>
                &lt;ul class="skus"&gt;<br>
                {$nbsp}&#123;foreach $product.skus as $sku&#125;<br>
                {$nbsp}{$nbsp}...<br>
                {$nbsp}{$nbsp}&lt;!-- Вывод цены со скидкой для артикула --&gt;<br>
                {$nbsp}{$nbsp}<b>&#123;shopFlexdiscountPluginHelper::price($product, $sku.id)&#125;</b><br>
                {$nbsp}&#123;/foreach&#125;<br>
                {$nbsp}...
            </div><br><br>
        </div>
        <p>Цена будет динамически обновляться, если к товару будет применена скидка, при изменении количества товара.</p>
    </div>
    <div class="flexdiscount-question"><a href="javascript:void(0)">11) Вывод цены со скидкой в корзину и ее обновление<i class="icon16 rarr"></i></a></div>
    <div class='flexdiscount-answer'>
        <p>Если Вы хотите, чтобы в корзине отображалась цена со скидкой для каждого товара, которая бы обновлялась при изменении/удалении товаров, необходимо 
            выполнить 2 условия:</p>
        <ol>
            <li>Внести изменения в файл <b><i>cart.js</i></b></li>
            <li>Использовать специальную конструкцию (см. ниже) для вывода цены в корзине</li>
        </ol>
        <p><u>Рассмотрим первый пункт.</u></p>
        <p>1) Вам необходимо зайти на страницу  Магазин -&gt; Витрина -&gt; Шаблоны -&gt; <i>cart.js</i>.</p>
        <p>2) Добавить код в функции, отвечающие за отслеживание изменений количества и удаление товаров:</p>
        <div class="align-center">
            <div class="print-code">
                if (typeof $.flexdiscountFrontend !== 'undefined') &#123;<br>
                {$nbsp}$.flexdiscountFrontend.cartChange();<br>
                &#125;<br>
            </div><br><br>
        </div>
        <p>Если Вы не уверены в своих знаниях - обратитесь к разработчику темы. Эта задача не займет у него более двух минут.</p>
        <p>Рассмотрим примеры для некоторых тем дизайна:</p>
        <p><b>Тема дизайна Default 2.0</b></p>
        <p>Примерно такой же порядок работы в темах Аскетик, Clear, Nifty, Custom, Facebook, Sidebar, Vkontakte и многих других.</p>
        <ol>
            <li>
                Найдите код
                <div class="align-center">
                    <div class="print-code">
                        {$nbsp}$(".cart input.qty").change(function () &#123;<br>
                        {$nbsp}{$nbsp}var that = $(this);<br>
                        {$nbsp}{$nbsp}if (that.val() > 0) &#123;<br>
                        {$nbsp}{$nbsp}{$nbsp}var row = that.closest('div.row');<br>
                        {$nbsp}{$nbsp}{$nbsp}if (that.val()) &#123;<br>
                        {$nbsp}{$nbsp}{$nbsp}{$nbsp}$.post('save/', &#123;html: 1, id: row.data('id'), quantity: that.val()&#125;, function (response) &#123;<br>
                        {$nbsp}{$nbsp}{$nbsp}{$nbsp}{$nbsp}row.find('.item-total').html(response.data.item_total);<br>
                        {$nbsp}{$nbsp}{$nbsp}{$nbsp}{$nbsp}if (response.data.q) &#123;<br>
                        {$nbsp}{$nbsp}{$nbsp}{$nbsp}{$nbsp}{$nbsp}that.val(response.data.q);<br>
                        {$nbsp}{$nbsp}{$nbsp}{$nbsp}{$nbsp}&#125;<br>
                        {$nbsp}{$nbsp}{$nbsp}{$nbsp}{$nbsp}if (response.data.error) &#123;<br>
                        {$nbsp}{$nbsp}{$nbsp}{$nbsp}{$nbsp}{$nbsp}alert(response.data.error);<br>
                        {$nbsp}{$nbsp}{$nbsp}{$nbsp}{$nbsp}&#125; else &#123;<br>
                        {$nbsp}{$nbsp}{$nbsp}{$nbsp}{$nbsp}{$nbsp}that.removeClass('error');<br>
                        {$nbsp}{$nbsp}{$nbsp}{$nbsp}{$nbsp}&#125;<br>
                        {$nbsp}{$nbsp}{$nbsp}{$nbsp}{$nbsp}updateCart(response.data);<br>
                        {$nbsp}{$nbsp}{$nbsp}{$nbsp}&#125;, "json");<br>
                        {$nbsp}{$nbsp}{$nbsp}&#125;<br>
                        {$nbsp}{$nbsp}&#125; else &#123;<br>
                        {$nbsp}{$nbsp}{$nbsp}that.val(1);<br>
                        {$nbsp}{$nbsp}&#125;<br>
                        {$nbsp}&#125;);
                    </div><br><br>
                </div>
                <p>И добавьте после "updateCart(response.data)" код, чтобы получилось так:</p>
                <div class="align-center">
                    <div class="print-code">
                        {$nbsp}$(".cart input.qty").change(function () &#123;<br>
                        {$nbsp}{$nbsp}var that = $(this);<br>
                        {$nbsp}{$nbsp}if (that.val() > 0) &#123;<br>
                        {$nbsp}{$nbsp}{$nbsp}var row = that.closest('div.row');<br>
                        {$nbsp}{$nbsp}{$nbsp}if (that.val()) &#123;<br>
                        {$nbsp}{$nbsp}{$nbsp}{$nbsp}$.post('save/', &#123;html: 1, id: row.data('id'), quantity: that.val()&#125;, function (response) &#123;<br>
                        {$nbsp}{$nbsp}{$nbsp}{$nbsp}{$nbsp}row.find('.item-total').html(response.data.item_total);<br>
                        {$nbsp}{$nbsp}{$nbsp}{$nbsp}{$nbsp}if (response.data.q) &#123;<br>
                        {$nbsp}{$nbsp}{$nbsp}{$nbsp}{$nbsp}{$nbsp}that.val(response.data.q);<br>
                        {$nbsp}{$nbsp}{$nbsp}{$nbsp}{$nbsp}&#125;<br>
                        {$nbsp}{$nbsp}{$nbsp}{$nbsp}{$nbsp}if (response.data.error) &#123;<br>
                        {$nbsp}{$nbsp}{$nbsp}{$nbsp}{$nbsp}{$nbsp}alert(response.data.error);<br>
                        {$nbsp}{$nbsp}{$nbsp}{$nbsp}{$nbsp}&#125; else &#123;<br>
                        {$nbsp}{$nbsp}{$nbsp}{$nbsp}{$nbsp}{$nbsp}that.removeClass('error');<br>
                        {$nbsp}{$nbsp}{$nbsp}{$nbsp}{$nbsp}&#125;<br>
                        {$nbsp}{$nbsp}{$nbsp}{$nbsp}{$nbsp}updateCart(response.data);<br>
                        {$nbsp}{$nbsp}{$nbsp}{$nbsp}{$nbsp}<b>if (typeof $.flexdiscountFrontend !== 'undefined') &#123;</b><br>
                        {$nbsp}{$nbsp}{$nbsp}{$nbsp}{$nbsp}{$nbsp}<b>$.flexdiscountFrontend.cartChange();</b><br>
                        {$nbsp}{$nbsp}{$nbsp}{$nbsp}{$nbsp}<b>&#125;</b><br>
                        {$nbsp}{$nbsp}{$nbsp}{$nbsp}&#125;, "json");<br>
                        {$nbsp}{$nbsp}{$nbsp}&#125;<br>
                        {$nbsp}{$nbsp}&#125; else &#123;<br>
                        {$nbsp}{$nbsp}{$nbsp}that.val(1);<br>
                        {$nbsp}{$nbsp}&#125;<br>
                        {$nbsp}&#125;);
                    </div><br><br>
                </div>
            </li>
            <li>
                Найдите код
                <div class="align-center">
                    <div class="print-code">
                        {$nbsp}$(".cart a.delete").click(function () &#123;<br>
                        {$nbsp}{$nbsp}var row = $(this).closest('div.row');<br>
                        {$nbsp}{$nbsp}$.post('delete/', &#123;html: 1, id: row.data('id')&#125;, function (response) &#123;<br>
                        {$nbsp}{$nbsp}{$nbsp}if (response.data.count == 0) &#123;<br>
                        {$nbsp}{$nbsp}{$nbsp}{$nbsp}location.reload();<br>
                        {$nbsp}{$nbsp}{$nbsp}&#125;<br>
                        {$nbsp}{$nbsp}{$nbsp}row.remove();<br>
                        {$nbsp}{$nbsp}{$nbsp}updateCart(response.data);<br>
                        {$nbsp}{$nbsp}&#125;, "json");<br>
                        {$nbsp}{$nbsp}return false;<br>
                        {$nbsp}&#125;);
                    </div><br><br>
                </div>
                <p>И добавьте после "updateCart(response.data)" код, чтобы получилось так:</p>
                <div class="align-center">
                    <div class="print-code">
                        {$nbsp}$(".cart a.delete").click(function () &#123;<br>
                        {$nbsp}{$nbsp}var row = $(this).closest('div.row');<br>
                        {$nbsp}{$nbsp}$.post('delete/', &#123;html: 1, id: row.data('id')&#125;, function (response) &#123;<br>
                        {$nbsp}{$nbsp}{$nbsp}if (response.data.count == 0) &#123;<br>
                        {$nbsp}{$nbsp}{$nbsp}{$nbsp}location.reload();<br>
                        {$nbsp}{$nbsp}{$nbsp}&#125;<br>
                        {$nbsp}{$nbsp}{$nbsp}row.remove();<br>
                        {$nbsp}{$nbsp}{$nbsp}updateCart(response.data);<br>
                        {$nbsp}{$nbsp}{$nbsp}<b>if (typeof $.flexdiscountFrontend !== 'undefined') &#123;</b><br>
                        {$nbsp}{$nbsp}{$nbsp}{$nbsp}<b>$.flexdiscountFrontend.cartChange();</b><br>
                        {$nbsp}{$nbsp}{$nbsp}<b>&#125;</b><br>
                        {$nbsp}{$nbsp}&#125;, "json");<br>
                        {$nbsp}{$nbsp}return false;<br>
                        {$nbsp}&#125;);
                    </div><br><br>
                </div>
            </li>
        </ol>
        <p><u>Рассмотрим второй пункт.</u></p>
        <p>Общая конструкция: &#123;shopFlexdiscountPluginHelper::cartPrice($product, $mult_quantity, $html, $format)&#125; , где<br>
            $product - массив с данными о товаре, <br>
            $mult_quantity - вывод цены с учетом количества товара или только для одной единицы товара (необязательный параметр). Допустимые значения 1 или 0. <br>
            $html - использовать символ рубля или нет (необязательный параметр). Допустимые значения 1 или 0.<br>
            $format - отображать цену с валютой или в чистом виде (необязательный параметр). Допустимые значения 1 или 0.<br>
        </p>
        <p>Код для корзины (шаблон cart.html). Вывод цены с учетом количества:</p>
        <div class="align-center">
            <div class="print-code">
                &#123;shopFlexdiscountPluginHelper::cartPrice($item)&#125;
            </div><br><br>
        </div>
        <p>Код для корзины (шаблон cart.html). Вывод цены для одной единицы товара:</p>
        <div class="align-center">
            <div class="print-code">
                &#123;shopFlexdiscountPluginHelper::cartPrice($item, 0)&#125;
            </div><br><br>
        </div>
        <p>Цены будут динамически обновляться при изменении количества товаров.</p>
    </div>
    <div class="flexdiscount-question"><a href="javascript:void(0)">12) Скидка для категорий пользователей и покупателей <i class="icon16 rarr"></i></a></div>
    <div class='flexdiscount-answer'>
        <p>В плагине предусморены скидки для категорий пользователей и покупателей. Узнать, какие у вас имеются категории пользователей можно в приложении <a href="{$wa_backend_url}contacts/" target="_blank">Контакты</a></p>
        <p>Каждой категории покупателей можно назначить любое правило скидок, с любым условием.</p>
        <p>Например, мы хотим, чтобы у всех пользователей из категории покупателей "Магазин" при покупке товаров на сумму большую, чем 50 000р. была скидка 20%.<br>
            Для этого в поле маска выбираем искомую категорию:</p>
        <img src="{$plugin_url}img/example13.jpg" alt="" />
        <p>Появится еще одно поле, в котором мы выберем нужную нам маску</p>
        <img src="{$plugin_url}img/example12.jpg" alt="" />
        <p>Таким образом можно гибко распределить скидки между вашими постоянными, оптовыми, зарегистрированными и будущими клиентами.</p>
    </div>
    <div class="flexdiscount-question"><a href="javascript:void(0)">13) Ограничение скидки для товара <i class="icon16 rarr"></i></a></div>
    <div class='flexdiscount-answer'>
        <p>Плагин позволяет ограничивать начисление скидок на товары. Используется формула, представленная ниже.</p>
        <img src="{$plugin_url}img/example14.jpg" class="adaptive-img" /><br>
        <p>Рассмотрим пример, как это работает.</p>
        <p><i>Пример, </i> пусть в корзине имеется 3 товара общей стоимостью 7300р:</p>
        <ul>
            <li>Яблоко - 5шт. Цена продажи 1000р. Цена закупки 850р. Стоимость 5шт: 5000р.</li>
            <li>Апельсин - 2шт. Цена продажи 800р. Цена закупки 600р. Стоимость 2шт: 1600р.</li>
            <li>Груша - 1шт. Цена продажи 700р. Цена закупки не указана. Стоимость 1шт: 700р.</li>
        </ul>
        <p>На все товары действует скидка 50%. Таким образом, цена товаров со скидкой 4650р.</p>
        <p>Предположим, что мы используем следующую формулу для ограничения скидки: <b><i>Цена закупки + 10% от цены закупки</i></b>.<br>
            Стоимость товаров будет равна 5995р.</p>
        <p>Как это получилось?</p>
        <p>Яблоки: Согласно формуле цена не может опуститься ниже 850 + 850*0,1 = 935р. Стоимость 5шт: 4675р.<br>
            Апельсины: Согласно формуле цена не может опуститься ниже 600 + 600*0,1 = 660р. Стоимость 2шт: 1320р.<br>
            Груша: Согласно формуле цена не изменится, потому что у груши не указана цена закупки. Стоимость 1шт: 0р.</p>
        <p>Граница, ниже которой цена за товары опуститься не может: 4675 + 1320 + 0 = 5995р.</p>
        <p>Рассмотрим другую формулу ограничения для тех же товаров: <b><i>Цена закупки + 10% от цены <u>товара</u></i></b>.</p>
        <p>Яблоки: 850 + 1000*0,1 = 950р. Стоимость 5шт: 4750р.<br>
            Апельсины: 600 + 800*0,1 = 680р. Стоимость 2шт: 1360р.<br>
            Груша: 0 + 700*0,1 = 70р. Стоимость 1шт: 70р.</p>
        <p>Граница, ниже которой цена за товары опуститься не может: 4750 + 1360 + 70 = 6180р.<br>Стоимость товаров будет равна 6180р.</p>
    </div>
    <div class="flexdiscount-question"><a href="javascript:void(0)">14) Создание собственных правил скидок (для разработчиков) <i class="icon16 rarr"></i></a></div>
    <div class='flexdiscount-answer'>
        <p>Плагин не был бы гибким, если бы в нем нельзя было создавать свои правила скидок, удовлетворяющие потребностям Вашего магазина.</p>
        <p>Вот, что Вам необходимо для создания новой скидки:</p>
        <ol>
            <li>Доступ к FTP;</li>
            <li>Знание PHP;</li>
        </ol>
        <p>Чтобы сообщить плагину, что вы создали новое правило необходимо:</p>
        <ol>
            <li>В каталоге <b><em>wa-apps/shop/plugins/flexdiscount/lib/config/</em></b> создать файл <b><em>custom_mask.php</em></b> с содержимым:<br>
                <div class="align-center">
                    <div class="print-code">
                        return array(<br>
                        {$nbsp}{$nbsp}"&gt;mymask" =&gt; array(<br>
                        {$nbsp}{$nbsp}{$nbsp}"module" =&gt; "mymaskMode",<br>
                        {$nbsp}{$nbsp}{$nbsp}"description" =&gt; "Описание моей скидки для пользователя",<br>
                        {$nbsp}{$nbsp}{$nbsp}"regexp" =&gt; array(<br>
                        {$nbsp}{$nbsp}{$nbsp}{$nbsp}array(<br>
                        {$nbsp}{$nbsp}{$nbsp}{$nbsp}{$nbsp}"pattern" =&gt; "mymask",<br>
                        {$nbsp}{$nbsp}{$nbsp}{$nbsp}{$nbsp}"replacement" =&gt; "0{ldelim}1,3{rdelim}",<br>
                        {$nbsp}{$nbsp}{$nbsp}{$nbsp}),<br>
                        {$nbsp}{$nbsp}{$nbsp}),<br>
                        {$nbsp}{$nbsp}"discountEachItem" =&gt; true,<br>
                        {$nbsp}),<br>
                        //... Другое правило<br>
                        );<br><br>
                    </div>
                </div>
                "&gt;mymask" - символьное обозначение скидки. Оно будет видно пользователю в общем списке масок.<br>
                ВНИМАНИЕ! Допустимые символы: '>', '<', '%', '#', '='. На конце можно оставлять только '#'<br>
                ЗАМЕЧАНИЕ! Вы можете переопределить работу системных правил скидок, указав одну из действующих масок. Таким образом, при 
                обновлении плагина Ваши изменения не будут стерты.<br><br>
                "module" =&gt; "mymaskMode" - название Вашего класса, в котором будет реализована логика скидки (об этом ниже).<br><br>
                "description" =&gt; - описание, которое будет появляться при наведении мышкой на голубое облачко возле маски.<br><br>
                "regexp" - при заполнении значения масок выставляется ограничение на вводимые символы и их количество.<br><br>
                "pattern" =&gt; "mymask" - слово, которое будет заменено на числовое значение. <br>
                ЗАМЕЧАНИЕ! Если у Вас в маске присутствует несколько слов (например, mymask#another), то Вам придется создать еще одно значение для
                массива regexp (пример можно посмотреть в системном файле <em>wa-apps/shop/plugins/flexdiscount/lib/config/config.php</em>)<br><br>
                "replacement" =&gt; "0{ldelim}1,3{rdelim}" - значение, на которое будет заменена строка "pattern".<br>
                0 - это все числа от 0 до 9. Если указать только 0, то пользователь сможет ввести лишь одно число. Если указать 00, то два<br>
                {ldelim}1,3{rdelim} - количество чисел, которые можно ввести пользователю в поле "Значение маски". В данном случае от одного до трех символов.<br><br>
                "discountEachItem" =&gt; true - единственный необязательный параметр. Он отвечает за вывод поля "Начислять скидку на каждый товар". Также это
                значение будет доступно при обработке скидки.
                <p>Изучите, как составлены системные правила в файле <em>wa-apps/shop/plugins/flexdiscount/lib/config/config.php</em></p>
            </li>
            <li>
                <p>Необходимо создать класс, для обработки созданного Вами правила.</p>
                <p>В предыдущем пункте мы создали маску "mymask" и указали модуль, который будет ее обрабатывать - "mymaskMode".</p>
                <p>В каталоге <b><em>wa-apps/shop/plugins/flexdiscount/lib/classes/discounts/</em></b> хранятся классы для обработки масок.<br>
                    Принцип формирования названия классов таков: </p>
                <div class="align-center">
                    <div class="print-code">
                        shopFlexdiscountPlugin<b>%MODULE%</b>Discount.class.php
                    </div>
                </div>
                <p>где %MODULE% - название модуля, которое Вы указали в предыдущем пункте</p>
                <p>Согласно нашему примеру необходимо созать файл:</p>
                <div class="align-center">
                    <div class="print-code">
                        shopFlexdiscountPlugin<b>MymaskMode</b>Discount.class.php
                    </div>
                </div>
                <p>ОБРАТИТЕ ВНИМАНИЕ! При создании класса первая буква должна быть с заглавная.</p>
            </li>
            <li>
                Структура класса скидок (на примере маски =num):
                <div class="align-center">
                    <div class="print-code">
                        &lt;?php<br>
                        <br>
                        /*<br>
                        * @author Gaponov Igor &lt;gapon2401@gmail.com&gt;<br>
                        * <br>
                        * При покупке Х любых товаров устанавливается общая скидка<br>
                        */<br>
                        <br>
                        class shopFlexdiscountPluginEqualDiscount extends shopFlexdiscountMask<br>
                        { <br>
                        <br>
                        {$nbsp}public function execute($params, $order, $categories, $contact, $apply)<br>
                        {$nbsp}{ <br>
                        {$nbsp}{$nbsp}$discount = $affiliate = $quantity = $price = 0;<br>
                        {$nbsp}{$nbsp}$items = $order['items'];<br>
                        {$nbsp}{$nbsp}$mask_info = self::getMaskInfo();
                        <br>
                        {$nbsp}{$nbsp}preg_match("/\d+/", $params['value'], $matches);<br>
                        {$nbsp}{$nbsp}$user_count = reset($matches);<br>
                        <br>
                        {$nbsp}{$nbsp}foreach ($items as $item) { <br>
                        {$nbsp}{$nbsp}{$nbsp}// Проверяем принадлежность товара к указанным категории и типу<br>
                        {$nbsp}{$nbsp}{$nbsp}if (!self::itemCheck($params, $item, $categories)) { <br>
                        {$nbsp}{$nbsp}{$nbsp}{$nbsp}continue;<br>
                        {$nbsp}{$nbsp}{$nbsp}&#125;<br>
                        <br>
                        {$nbsp}{$nbsp}{$nbsp}$quantity += (int) $item['quantity'];<br>
                        {$nbsp}{$nbsp}{$nbsp}$price += $item['price'] * $item['quantity'];<br>
                        {$nbsp}{$nbsp}&#125;<br>
                        {$nbsp}{$nbsp}if ($quantity &gt;= $user_count) { <br>
                        {$nbsp}{$nbsp}{$nbsp}if ($params['discount_percentage']) { <br>
                        {$nbsp}{$nbsp}{$nbsp}{$nbsp}$discount += max(0.0, min(100.0, (float) $params['discount_percentage'])) * $price / 100.0;<br>
                        {$nbsp}{$nbsp}{$nbsp}&#125;<br>
                        {$nbsp}{$nbsp}{$nbsp}if ($params['discount'] && $params['discount'] &gt; 0) { <br>
                        {$nbsp}{$nbsp}{$nbsp}{$nbsp}$discount += $params['discount'] * (!empty($mask_info['discountEachItem']) && $params['discounteachitem'] ? $quantity : 1);<br>
                        {$nbsp}{$nbsp}{$nbsp}&#125;<br>
                        {$nbsp}{$nbsp}{$nbsp}if ($params['affiliate'] && $params['affiliate'] &gt; 0) { <br>
                        {$nbsp}{$nbsp}{$nbsp}{$nbsp}$affiliate += $params['affiliate'] * (!empty($mask_info['discountEachItem']) && $params['discounteachitem'] ? $quantity : 1);<br>
                        {$nbsp}{$nbsp}{$nbsp}&#125;<br>
                        {$nbsp}{$nbsp}&#125;<br>
                        <br>
                        {$nbsp}{$nbsp}return ($discount || $affiliate) ? array("discount" =&gt; $discount, "affiliate" => $affiliate) : 0;<br>
                        {$nbsp}&#125;<br>
                        <br>
                        }<br>
                    </div>
                </div>
                <p>Название класса должно совпадать с названием файла.</p>
                <p>Метод <em>execute</em> принимает 5 параметров:</p>
                <div class="align-center">
                    <div class="print-code">
                        $params = array( Информация о скидке<br> 
                        {$nbsp}'mask' =&gt; маска <br>
                        {$nbsp}'value' =&gt; значение маски<br>
                        {$nbsp}'discount_percentage' =&gt; скидка в процентах<br>
                        {$nbsp}'category_id' =&gt; ID категории<br>
                        {$nbsp}'type_id' =&gt; ID типа товара<br>
                        {$nbsp}'set_id' =&gt; ID сета<br>
                        {$nbsp}'coupon_id' =&gt; ID купона<br>
                        {$nbsp}'name' =&gt; название скидки<br>
                        {$nbsp}'affiliate' =&gt; бонусы<br>
                        {$nbsp}'code' =&gt; символьный код<br>
                        {$nbsp}'contact_category_id' =&gt; ID категории контакта<br>
                        {$nbsp}'discounteachitem' =&gt; флаг "Начислять скидку на каждый товар"<br>
                        );
                    </div>
                </div><br>
                <div class="align-center">
                    <div class="print-code">
                        $order =&gt; array( Информация о заказе<br> 
                        {$nbsp}'total' =&gt; общая сумма заказа<br>
                        {$nbsp}'items' =&gt; array( товары, входящие в заказ<br>
                        {$nbsp}{$nbsp}...<br>
                        {$nbsp});<br>
                        );
                    </div>
                </div><br>
                <div class="align-center">
                    <div class="print-code">
                        $categories =&gt; array( Категории товаров. Используются при проверке запрета на скидку<br> 
                        {$nbsp}...<br>
                        );
                    </div>
                </div><br>
                <div class="align-center">
                    <div class="print-code">
                        $contact =&gt; array( Информация о контакте. waAuthUser<br> 
                        {$nbsp}...<br>
                        );
                    </div>
                </div><br>
                <div class="align-center">
                    <div class="print-code">
                        $apply =&gt; (bool) Был ли оформлен заказ или нет<br> 
                    </div>
                </div>
                <p>Доступные статические методы:</p>
                <div class="align-center">
                    <div class="print-code">
                        /**<br>
                        * Check, if item is ready to get discount. <br>
                        * Method checks categories, types and sets of the item<br>
                        * <br>
                        * @param array $params<br>
                        * @param array $item<br>
                        * @param array $categories<br>
                        * @param bool $deny_check - check through the deny categories, types, sets<br>
                        * @return boolean<br>
                        */<br>
                        self::itemCheck($params, $item, $categories, $deny_check = true) 
                    </div>
                </div><br>
                <div class="align-center">
                    <div class="print-code">
                        /**<br>
                        * Info about mask in config file<br>
                        */<br>
                        self::getMaskInfo()
                    </div>
                </div><br>
                <div class="align-center">
                    <div class="print-code">
                        /**<br>
                        * Info about coupon<br>
                        */<br>
                        self::getCouponInfo()
                    </div>
                </div>
                <p>Метод <em>execute()</em> должен возвращать массив, либо 0:</p>
                <div class="align-center">
                    <div class="print-code">
                        array(<br>
                        {$nbsp}"discount" => (float) - размер скидки <br>
                        {$nbsp}"affiliate" => (int) размер бонусов<br>
                        )<br>
                    </div>
                </div>
            </li>
        </ol>
        <p>ВНИМАНИЕ! При удалении своих правил скидок сначала удаляйте их из админ части, потом из кода.</p>
    </div>
</div>